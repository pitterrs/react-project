import React, { useMemo, useEffect } from "react";
import MaterialCard from '@material-ui/core/Card';
import classNames from 'classnames';
import styles from './Accordion.module.scss';
import AccordionContext from './AccordionContext';

export const Accordion = ({ variant, onSelect, className, children, ...props }) => {
  let grayBg = variant === 'gray-bg';

  let Component = grayBg ? 'div' : MaterialCard;

  let classes = classNames(
    grayBg && styles.accordionGrayBg,
    !grayBg && styles.accordion,
    className
  );
  const [activeKey, setActiveKey] = React.useState(null);

  const handleChange = (panel, newExpanded) => {
    console.log("newExpanded is " + newExpanded);
    console.log("panel is " + panel);
    // This set state hook is async so it doesn't return the value before the event is over.
    setActiveKey(newExpanded ? panel : false);
  };

  return (
    <AccordionContext.Provider value={{ activeKey, handleChange }}>
      <Component variant={variant} className={classes} {...props}>
        {children}
      </Component>
    </AccordionContext.Provider>
  );
};
