const SelectMenu = function (H) {

    const SelectMenu = function (element) {
        var self = this;

        self.$e = H.logEl(element, 'Select: ');
        self.$pe = H.logEl(element.parentElement, '|- Parent Element');

    }

    SelectMenu.selector = '.input-group .custom-select';

    /**
     * detect IE
     * returns version of IE or false, if browser is not Internet Explorer
     * https://stackoverflow.com/questions/19999388/check-if-user-is-using-ie-with-jquery
     */
    function detectIE() {
        var ua = window.navigator.userAgent;

        var msie = ua.indexOf('MSIE ');
        if (msie > 0) {
            // IE 10 or older => return version number
            return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
        }

        var trident = ua.indexOf('Trident/');
        if (trident > 0) {
            // IE 11 => return version number
            var rv = ua.indexOf('rv:');
            return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
        }

        var edge = ua.indexOf('Edge/');
        if (edge > 0) {
            // Edge (IE 12+) => return version number
            return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
        }

        // other browser
        return false;
    }

    SelectMenu.prototype = {

        updateLabel: function () {
            var updatedLabel = $(this.$e).find('option:selected').text();
            $(this.$pe).find('.uxf-custom-select').text(updatedLabel);

            if ($(this.$pe).hasClass('input-group-prepend') && !detectIE()) {
                $(this.$pe).siblings('.uxf-search-bar').focus();
            }
        },
    }

    H.SelectMenu = function (a) {
        return new SelectMenu(H.elementOrId(a));
    }

    H.Register.SelectMenu = function (e) {
        H.registerEvents(SelectMenu.selector, 'change', SelectMenu, 'updateLabel', e);
    }

    H.defaultRegister(H.Register.SelectMenu);

};

module.exports = SelectMenu;
